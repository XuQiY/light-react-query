var Z=Object.defineProperty,k=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var S=(c,s,a)=>s in c?Z(c,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[s]=a,y=(c,s)=>{for(var a in s||(s={}))te.call(s,a)&&S(c,a,s[a]);if(R)for(var a of R(s))re.call(s,a)&&S(c,a,s[a]);return c},O=(c,s)=>k(c,ee(s));var p=(c,s,a)=>(S(c,typeof s!="symbol"?s+"":s,a),a);(function(c,s){typeof exports=="object"&&typeof module!="undefined"?s(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],s):(c=typeof globalThis!="undefined"?globalThis:c||self,s(c["light-react-query"]={},c.React))})(this,function(c,s){"use strict";function a(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var g=a(s);class A{constructor(){p(this,"queue");this.queue={},this.subscribeVisibilityChange()}subscribeVisibilityChange(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&Object.keys(this.queue).forEach(e=>{this.queue[e]()})})}addSubscribe(e,t){this.queue[e]=t}removeSubscribe(e){delete this.queue[e]}hasSubscribe(e){return!!this.queue[e]}}class H{constructor(){p(this,"cacheList");p(this,"focusHandle");this.cacheList={},this.focusHandle=new A}setCache(e,t){this.cacheList[e]?this.updateCache(e,t):this.cacheList[e]=O(y({},t),{timer:this.setTimeOutToClear(t.cacheTime,e)})}getCache(e){return y({},this.cacheList[e])}updateCache(e,t){const n=this.cacheList[e].timer;this.clearTimeOut(n),this.cacheList[e]=O(y({},t),{timer:this.setTimeOutToClear(t.cacheTime,e)})}clearCache(e){delete this.cacheList[e]}setTimeOutToClear(e,t){return setTimeout(()=>{this.clearCache(t)},e)}clearTimeOut(e){clearTimeout(e)}}var _={exports:{}},m={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var T=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;function U(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function M(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de",Object.getOwnPropertyNames(r)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var n=Object.getOwnPropertyNames(e).map(function(i){return e[i]});if(n.join("")!=="0123456789")return!1;var u={};return"abcdefghijklmnopqrst".split("").forEach(function(i){u[i]=i}),Object.keys(Object.assign({},u)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}M();/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V=g.default,C=60103;if(m.Fragment=60107,typeof Symbol=="function"&&Symbol.for){var E=Symbol.for;C=E("react.element"),m.Fragment=E("react.fragment")}var W=V.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Y=Object.prototype.hasOwnProperty,z={key:!0,ref:!0,__self:!0,__source:!0};function w(r,e,t){var n,u={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Y.call(e,n)&&!z.hasOwnProperty(n)&&(u[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)u[n]===void 0&&(u[n]=e[n]);return{$$typeof:C,type:r,key:i,ref:o,props:u,_owner:W.current}}m.jsx=w,m.jsxs=w,_.exports=m;const $=_.exports.jsx,L=g.default.createContext({});function B({children:r}){const e=g.default.useRef(new H);return $(L.Provider,{value:e.current,children:r})}function P(r,e){if(r===e)return r;const t=Array.isArray(r)&&Array.isArray(e);if(t||q(r)&&q(e)){const n=t?r.length:Object.keys(r).length,u=t?e:Object.keys(e),i=u.length,o=t?[]:{};let f=0;for(let b=0;b<i;b++){const h=t?b:u[b];o[h]=P(r[h],e[h]),o[h]===r[h]&&f++}return n===i&&f===n?r:o}return e}function q(r){if(!x(r))return!1;const e=r.constructor;if(typeof e=="undefined")return!0;const t=e.prototype;return!(!x(t)||!t.hasOwnProperty("isPrototypeOf"))}function x(r){return Object.prototype.toString.call(r)==="[object Object]"}const J=20*1e3,G=3*1e3,K=(r,e,t)=>{const n=s.useContext(L),[u,i]=s.useState(!n.getCache(r)),[o,f]=s.useState(!1),[b,h]=s.useState(!1),[X,F]=s.useState(),v=s.useRef(0);s.useEffect(()=>{I(r),D(r)},[]),s.useEffect(()=>{t!=null&&t.refetchOnWindowFocus?D(r):n.focusHandle.hasSubscribe(r)&&n.focusHandle.removeSubscribe(r)},[t.refetchOnWindowFocus]);const j=async l=>{h(!0);try{const d=await e();i(!1),h(!1),P(d,n.getCache(l))||F(d),n.setCache(l,O(y({data:d},t),{cacheTime:(t==null?void 0:t.cacheTime)||J})),v.current=0}catch{t.retry&&t.retry>v.current&&setTimeout(()=>{j(l),v.current+=1},t.retryTime||G),f(!0)}},I=l=>{const d=n.getCache(l);d?(F(d.data),j(l)):(i(!0),j(l))},D=l=>{n.focusHandle.addSubscribe(l,()=>I(l))};return{isLoading:u,isError:o,isFetching:b,data:X}};c.ReactQueryProvider=B,c.useQuery=K,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
